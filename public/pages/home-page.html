<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-toast/paper-toast.html">
<link rel="import" href="/bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="/bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="/bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="/bower_components/core-menu/core-menu.html">
<link rel="import" href="/bower_components/core-item/core-item.html">
<!--<link rel="import" href="/bower_components/baasic-login/baasic-login.html">-->
<link rel="import" href="/layouts/sidebar-layout.html">
<link rel="import" href="/pages/app-ajax.html">

<link rel="stylesheet" href="/pages/signin.css">
<polymer-element name="home-page" router="{{router}}" attributes="pathArg1 queryParam1 access_token">    
    <template>
         <baasic-globals id="globals"></baasic-globals>
        <!--<baasic-login id="log"></baasic-login>-->
        <sidebar-layout selected="home">

            <form id="form" action="/Home" method="post" enctype="multipart/form-data">

                <!--<core-scaffold>-->
                <!--
                                <core-header-panel navigation flex mode="seamed">
                                    <core-toolbar style="background-color: #526E9C; color: #fff;">WELCOME TO SMS</core-toolbar>
                                    <core-menu>
                                        <core-item icon="home" label="Home" >
                                        </core-item>
                                        <core-item icon="settings" label="Administration" on-click="{{adminCall}}">
                                            <a href="/pages/admin-page.html"></a> 
                                        </core-item>
                                        <core-item icon="settings" label="Sign Out" on-click="{{signOut}}"></core-item>
                                    </core-menu>
                                </core-header-panel>-->

                <div>Welcome To Home Page</div>
                    <!--<h6><paper-button on-click="{{signOut}}" id="sign-out" name="signout">Sign Out</paper-button></h6></div>-->

                <div id="home-div">
                    <br><br>
                    <img src="/pages/test1.jpg" width="300" height="150" alt="Today's Lecture">
                    <img src="/pages/test2.gif" width="300" height="150" alt="Today's Lecture">
                    <p>
                        Today is 18th of December and we have 6 Lectures in total
                        <br> But the most important Lectures as mention above in 
                        <br> todays images will be conducted in afternoon by professor
                        <br> P.K Smith.<br>
                    </p>
                    <br><br>
                </div>
                <div class="administrator" id="administrator-div">
                    <h3>Please Insert,Update or Delete Users records from here!</h3>                
                    User Name:<br>
                    <input type="text" id="newusername" name="new-username">
                    <br>
                    User Password:
                    <br>
                    <input type="password" id="newpassword" name="new-password">
                    <input type="hidden" name="action" id="action">
                    &nbsp;
                    <paper-toast id="toast1" text="Database is Updated Successfully!" on-click="{{dataResponse(el)}}" opened="false"></paper-toast>
                    <!--<paper-toast id="toast2" text="Sorry Database is not Updated." on-click="{{dataResponse(el)}}" opened="false"></paper-toast>-->
                    <br><br>
                    <paper-button on-click="{{sty}}" class="my-action-button" id="my-button" name="insert">Insert</paper-button>
                    &nbsp;
                    <paper-button on-click="{{sty}}" class="my-action-button" id="my-button" name="update">Update</paper-button>
                    &nbsp;
                    <paper-button on-click="{{sty}}" class="my-action-button" id="my-button" name="delete">Delete</paper-button>
                    <br>
                </div>


                <!--<div tool>Home</div>-->
                <!--</core-scaffold>-->
                <app-ajax id="ajax"
                           url="/home"
                           method="POST"
                           on-core-response="{{homeResponse}}"
                           content-type="application/json"
                           access_token="{{access_token}}"
                           handleAs="json">
                </app-ajax>
            </form>
        </sidebar-layout>

    </template>
    <script>
        Polymer('home-page', {
                
            sty: function (e, detail, sender) {
                //                console.log(this.$.newusername.value);

                var newusername = this.$.newusername.value;
                var newpassword = this.$.newpassword.value;
                if(newusername == '' || newpassword == '')
                {
                    this.$.toast1.text="Username or Password Field Is Empty. Please Fill All Fields!";
                    this.$.toast1.opened="true";
                    console.log("not submit");
                        
                    //this.redirect('/signin-page');
                }
                else
                {
                        
                    var name = e.target.getAttribute('name');
                    this.$.action.value = name;
                    //                form.submit();
                    this.$.ajax.data = {newusername:newusername, newpassword:newpassword,action:name};
//                    console.log(this.$.ajax.body);
                    this.$.ajax.go();

                }
            },
            homeResponse: function()
            {
                console.log(this.$.ajax.response.data);
                if(this.$.ajax.response.status==true)
                {
                    //                    this.$.toast1.text="DataBase Updated!!!"
                    this.$.toast1.opened="true";
                    var app = document.querySelector("index-app");
                    //                        console.log(this.router);
                    app.session=true;
                    
                    //                    this.router.go('/home', {replace:true});
                    //res.send();
                        
                }
                else
                {
                    this.$.toast1.text="Database is not Updated!!! Please Verify Your Details";
                    this.$.toast1.opened="true";
                }
            },
            dataResponse : function(el)
            {
                el.show();
            },
            //            init: function(){
            //                console.log(this.$.router);
            //                this.$.router.init();  
            //            },
//            signOut : function()
//            {
//                //                console.log(this.router);
//                //var app = document.querySelector('baasic-login');
//                //console.log("test-home-signout");
//                //var globals = this.$.globals;
//                this.$.log.logOut();
//                //var app = document.querySelector('index-app');
//                //app.$.session=false;
//                //app.init();
//
//                //                app.init();     
//                // redirect to the login page if not signed in
//                //app.$.router.go('/signin');
//                //                this.$.toast1.text="Sign Out Successfully";
//                //                this.$.toast1.opened="true";
//            },
            adminCall : function()
            {
                var app = document.querySelector('index-app');

                if(app.session)
                {
                    this.router.go('/admin');
                    //                    app.session=true;
                }
                else
                {
                    this.router.go('/signin');
                }
            },
            ready: function(){
//                console.log(this.$.globals.baasicUser)
                this.access_token = this.$.globals.baasicUser.accessToken;
            }
            
           
            
        });
    </script>
</polymer-element>