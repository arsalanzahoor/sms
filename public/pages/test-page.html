


<!--<link rel="import" href="/bower_components/polymer/polymer.html">-->
<link rel="import" href="/bower_components/core-scroll-threshold/core-scroll-threshold.html">

<link rel="import" href="/pages/app-ajax.html">
<script src="/pages/date.js"></script>


<polymer-element name="test-page" layout vertical attribute="employeeattendance employeeid">
    <template>
        <sidebar-layout selected="test">
            <style>
                #scroller {
                    height: 300px;
                    border: 1px solid blue;
                    padding: 10px;
                    margin-top: 45px;
                    overflow: auto;
                }
                .thing {
                    text-align: left;
                    padding-left: 20px;
                    margin-left: 10px;
                    background: lightblue;
                    border-radius: 40px;
                    font-size: 1.2em;
                }
                .header {
                    text-align: left;
                    padding-left: 20px;
                    margin-left: 0px;
                    margin-right: 10px;
                    background: lightblue;
                    border-radius: 10px;
                    font-size: 1.2em;
                    
                }
                .table {
                    alignment-adjust: initial;  
                    text-align: left; 
                    font-style: oblique;
                    display: inline-block;  
                    /*border: 1px solid red;*/
                    border-spacing: 100px;
                    border-collapse: collapse; 
                    padding: 20px;
                    width: auto;
                    margin-left: 5px;
                    column-width: 50px;
                }
                .tabledata {
                    text-align: left; 
                    font-style: oblique;
                    display: inline-block;  
                    border: 1px solid red;
                    border-spacing: 100px;
                    border-collapse: collapse; 
                    padding: 10px;
                    width: auto;
                }
            </style>
            <table class="table">
                <!--                <thead><tr>
                                <template if ="{{!employeeid}}" >
                                    <th>Employee First Name</th>
                                    <th>Employee Last Name</th>
                                </template>
                                <th>Attendance Date</th>
                                <th>CheckIn Time</th>
                                <th>CheckOut Time</th>
                                </tr></thead>-->

                <core-scroll-threshold id="threshold" scrollTarget="{{$.scroller}}" lowerThreshold="100" on-lower-trigger="{{loadMore}}" fit></core-scroll-threshold>
                <tbody id="scroller" fit >
               
                    <tr>
                    <div class="header">
                        <!--<template if ="{{!employeeid}}">-->
                        <b><i>Employee Name</i></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <!--</template>--> 
                        <b><i>Attendance Date</i></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                        <b><i>CheckIn Time</i></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                        <b><i>CheckOut Time</i></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    </div>
                    </tr>
               
                <template repeat="{{attendance in employeeattendance}}">
                    <tr>
                    <div class="thing">
                        <!--<template if ="{{!employeeid}}">-->
                            <span>{{attendance.FirstName}} {{attendance.LastName}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <!--</template>--> 
                        <span>{{attendance.Attendence | date(yyyy/mm/dd)}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                        <span>{{attendance.timein | date('HH-mm-ss')}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                        <span>{{(attendance.timein === attendance.timeout) ? '' : attendance.timeout | date('HH-mm-ss') }}</span></div>
                    </tr></template>

                <!--                <template repeat="{{attendance in employeeattendance}}">
                
                                    <tr>
                                        <div class="thing"><b><u>Employee Name:</u></b><i>{{attendance.FirstName}} {{attendance.LastName}}</i> <b><u>Attendance Date:</u></b><i>{{attendance.Attendence | date(yyyy/mm/dd)}}</i> <b><u>CheckIn Time:</u></b><i>{{attendance.timein | date('HH-mm-ss')}}</i> <b><u>CheckOut Time:</u></b><i>{{(attendance.timein === attendance.timeout) ? '' : attendance.timeout | date('HH-mm-ss') }}</i></div>
                                    <template if ="{{!employeeid}}">
                                        <td>{{attendance.FirstName}}</td>
                                        <td>{{attendance.LastName}}</td>
                                    </template>
                                    <td>{{attendance.Attendence | date (yyyy/mm/dd)}}</td>
                                    <td>{{attendance.timein | date('HH-mm-ss')}}</td>
                                    <td> {{(attendance.timein === attendance.timeout) ? '' : attendance.timeout | date('HH-mm-ss') }}</td> 
                                    </tr>
                                    <div class="thing"><b><u>Employee Name:</u></b><i>{{attendance.FirstName}} {{attendance.LastName}}</i> <b><u>Attendance Date:</u></b><i>{{attendance.Attendence | date(yyyy/mm/dd)}}</i> <b><u>CheckIn Time:</u></b><i>{{attendance.timein | date('HH-mm-ss')}}</i> <b><u>CheckOut Time:</u></b><i>{{(attendance.timein === attendance.timeout) ? '' : attendance.timeout | date('HH-mm-ss') }}</i></div>
                                </template>-->
                </tbody>


            </table>
            <!--<div hidden?="{{!$.threshold.lowerTriggered}}">Please wait...</div>-->

        </sidebar-layout>
        <app-ajax id="ajax"
                  url="/api/employeeattendence/report"
                  method="GET"
                  on-core-response="{{reportResponse}}"
                  content-type="application/json"
                  handleAs="json">
        </app-ajax>
    </template>

    <script>
        Polymer('test-page',{
            //            ready : function() {
            //                var scope = this;
            //                var n;
            //                scope.data = [];
            //                for (n=0; n<20; n++) {
            //                    scope.data.push(n);
            //                }
            //                console.log(scope.data);
            //                scope.loadMore = function() {
            //                    setTimeout(function() {
            //                        for (var i=n; i<n+10; i++) {
            //                            scope.data.push(i);
            //                        }
            //                            
            //                        n = i;
            //                        scope.$.threshold.clearLower();
            //                    }, 1000);
            //                };
            //            },
            domReady : function(){
                document.title = "Test";
                this.employeeattendance = this.employeeattendance || [];
                var fromdate = '2014/01/01';
                var todate = '2015/01/01';
                this.employeeid = '6'
                var EmployeeID = this.employeeid;
                //                var employeeid = '4';
                //                if(employeeid != '') {
                ////                    this.$.ajax1.data = {employeeid:employeeid};
                ////                    this.$.ajax1.go();
                ////                    this.$.empname.type=true;
                //                
                //                }
                //                this.access_token = this.$.globals.baasicUser.accessToken;
                console.log(fromdate,todate,EmployeeID);
                this.$.ajax.data = {fromdate:fromdate, todate:todate, EmployeeID:EmployeeID};
                this.$.ajax.go();
            
            },
            reportResponse : function(){
                if(this.$.ajax.response.status==true)
                {
                    console.log(this.$.ajax.response.data);
                    //                    for(var i=0;i<this.$.ajax.response.data.length;i++)
                    //                    {
                    //                        if(this.$.ajax.response.data[i].timein == this.$.ajax.response.data[i].timeout)
                    //                        {
                    //                            console.log(moment().duration().get(this.$.ajax.response.data[i].timein));
                    //                            this.$.ajax.response.data[i].timeout  = null;
                    //                        }
                    //                        else
                    //                        {
                    //                            this.$.ajax.response.data[i] = this.$.ajax.response.data[i];
                    //                        }
                    //                    }
                    
                    this.employeeattendance = this.$.ajax.response.data;
                }
                else
                {
                    this.$.toast1.text="There Is an Error on Attendance Report Request/Response";
                    this.$.toast1.opened="true";
                }
                
            },
            employeeResponse: function()
            {
                if(this.$.ajax1.response.status==true)
                {
                    this.employeename = (this.$.ajax1.response.data[0].FirstName +' '+ this.$.ajax1.response.data[0].LastName);
                }
                else
                {
                    this.$.toast1.text="There is an Error on Employees Request/Response";
                    this.$.toast1.opened="true";
                }
            },
            dataResponse : function(el)
            {
                el.show();
            }
            
        });
    </script>
</polymer-element>
